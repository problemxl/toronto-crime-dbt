
  create view "postgres"."toronto_crime"."stg_neighbourhood_crime__dbt_tmp"
    
    
  as (
    with source as (

    SELECT * from "postgres"."toronto_crime"."raw_crime_data"

),
renamed as (
    select
        "OBJECTID" AS neighbourhood_id,
        "AREA_NAME" AS neighbourhood_name,
        "HOOD_ID" AS hood_id,
        "POPN_PROJ_2022" AS population,
        "ASSAULT_2014" AS assault_2014,
        "ASSAULT_2015" AS assault_2015,
        "ASSAULT_2016" AS assault_2016,
        "ASSAULT_2017" AS assault_2017,
        "ASSAULT_2018" AS assault_2018,
        "ASSAULT_2019" AS assault_2019,
        "ASSAULT_2020" AS assault_2020,
        "ASSAULT_2021" AS assault_2021,
        "ASSAULT_2022" AS assault_2022,
        "ASSAULT_RATE_2014" AS assault_rate_2014,
        "ASSAULT_RATE_2015" AS assault_rate_2015,
        "ASSAULT_RATE_2016" AS assault_rate_2016,
        "ASSAULT_RATE_2017" AS assault_rate_2017,
        "ASSAULT_RATE_2018" AS assault_rate_2018,
        "ASSAULT_RATE_2019" AS assault_rate_2019,
        "ASSAULT_RATE_2020" AS assault_rate_2020,
        "ASSAULT_RATE_2021" AS assault_rate_2021,
        "ASSAULT_RATE_2022" AS assault_rate_2022,
        "AUTOTHEFT_2014" AS autotheft_2014,
        "AUTOTHEFT_2015" AS autotheft_2015,
        "AUTOTHEFT_2016" AS autotheft_2016,
        "AUTOTHEFT_2017" AS autotheft_2017,
        "AUTOTHEFT_2018" AS autotheft_2018,
        "AUTOTHEFT_2019" AS autotheft_2019,
        "AUTOTHEFT_2020" AS autotheft_2020,
        "AUTOTHEFT_2021" AS autotheft_2021,
        "AUTOTHEFT_2022" AS autotheft_2022,
        "AUTOTHEFT_RATE_2014" AS autotheft_rate_2014,
        "AUTOTHEFT_RATE_2015" AS autotheft_rate_2015,
        "AUTOTHEFT_RATE_2016" AS autotheft_rate_2016,
        "AUTOTHEFT_RATE_2017" AS autotheft_rate_2017,
        "AUTOTHEFT_RATE_2018" AS autotheft_rate_2018,
        "AUTOTHEFT_RATE_2019" AS autotheft_rate_2019,
        "AUTOTHEFT_RATE_2020" AS autotheft_rate_2020,
        "AUTOTHEFT_RATE_2021" AS autotheft_rate_2021,
        "AUTOTHEFT_RATE_2022" AS autotheft_rate_2022,
        "BIKETHEFT_2014" AS biketheft_2014,
        "BIKETHEFT_2015" AS biketheft_2015,
        "BIKETHEFT_2016" AS biketheft_2016,
        "BIKETHEFT_2017" AS biketheft_2017,
        "BIKETHEFT_2018" AS biketheft_2018,
        "BIKETHEFT_2019" AS biketheft_2019,
        "BIKETHEFT_2020" AS biketheft_2020,
        "BIKETHEFT_2021" AS biketheft_2021,
        "BIKETHEFT_2022" AS biketheft_2022,
        "BIKETHEFT_RATE_2014" AS biketheft_rate_2014,
        "BIKETHEFT_RATE_2015" AS biketheft_rate_2015,
        "BIKETHEFT_RATE_2016" AS biketheft_rate_2016,
        "BIKETHEFT_RATE_2017" AS biketheft_rate_2017,
        "BIKETHEFT_RATE_2018" AS biketheft_rate_2018,
        "BIKETHEFT_RATE_2019" AS biketheft_rate_2019,
        "BIKETHEFT_RATE_2020" AS biketheft_rate_2020,
        "BIKETHEFT_RATE_2021" AS biketheft_rate_2021,
        "BIKETHEFT_RATE_2022" AS biketheft_rate_2022,
        "BREAKENTER_2014" AS breakenter_2014,
        "BREAKENTER_2015" AS breakenter_2015,
        "BREAKENTER_2016" AS breakenter_2016,
        "BREAKENTER_2017" AS breakenter_2017,
        "BREAKENTER_2018" AS breakenter_2018,
        "BREAKENTER_2019" AS breakenter_2019,
        "BREAKENTER_2020" AS breakenter_2020,
        "BREAKENTER_2021" AS breakenter_2021,
        "BREAKENTER_2022" AS breakenter_2022,
        "BREAKENTER_RATE_2014" AS breakenter_rate_2014,
        "BREAKENTER_RATE_2015" AS breakenter_rate_2015,
        "BREAKENTER_RATE_2016" AS breakenter_rate_2016,
        "BREAKENTER_RATE_2017" AS breakenter_rate_2017,
        "BREAKENTER_RATE_2018" AS breakenter_rate_2018,
        "BREAKENTER_RATE_2019" AS breakenter_rate_2019,
        "BREAKENTER_RATE_2020" AS breakenter_rate_2020,
        "BREAKENTER_RATE_2021" AS breakenter_rate_2021,
        "BREAKENTER_RATE_2022" AS breakenter_rate_2022,
        "HOMICIDE_2014" AS homicide_2014,
        "HOMICIDE_2015" AS homicide_2015,
        "HOMICIDE_2016" AS homicide_2016,
        "HOMICIDE_2017" AS homicide_2017,
        "HOMICIDE_2018" AS homicide_2018,
        "HOMICIDE_2019" AS homicide_2019,
        "HOMICIDE_2020" AS homicide_2020,
        "HOMICIDE_2021" AS homicide_2021,
        "HOMICIDE_2022" AS homicide_2022,
        "HOMICIDE_RATE_2014" AS homicide_rate_2014,
        "HOMICIDE_RATE_2015" AS homicide_rate_2015,
        "HOMICIDE_RATE_2016" AS homicide_rate_2016,
        "HOMICIDE_RATE_2017" AS homicide_rate_2017,
        "HOMICIDE_RATE_2018" AS homicide_rate_2018,
        "HOMICIDE_RATE_2019" AS homicide_rate_2019,
        "HOMICIDE_RATE_2020" AS homicide_rate_2020,
        "HOMICIDE_RATE_2021" AS homicide_rate_2021,
        "HOMICIDE_RATE_2022" AS homicide_rate_2022,
        "ROBBERY_2014" AS robbery_2014,
        "ROBBERY_2015" AS robbery_2015,
        "ROBBERY_2016" AS robbery_2016,
        "ROBBERY_2017" AS robbery_2017,
        "ROBBERY_2018" AS robbery_2018,
        "ROBBERY_2019" AS robbery_2019,
        "ROBBERY_2020" AS robbery_2020,
        "ROBBERY_2021" AS robbery_2021,
        "ROBBERY_2022" AS robbery_2022,
        "ROBBERY_RATE_2014" AS robbery_rate_2014,
        "ROBBERY_RATE_2015" AS robbery_rate_2015,
        "ROBBERY_RATE_2016" AS robbery_rate_2016,
        "ROBBERY_RATE_2017" AS robbery_rate_2017,
        "ROBBERY_RATE_2018" AS robbery_rate_2018,
        "ROBBERY_RATE_2019" AS robbery_rate_2019,
        "ROBBERY_RATE_2020" AS robbery_rate_2020,
        "ROBBERY_RATE_2021" AS robbery_rate_2021,
        "ROBBERY_RATE_2022" AS robbery_rate_2022,
        "SHOOTING_2014" AS shooting_2014,
        "SHOOTING_2015" AS shooting_2015,
        "SHOOTING_2016" AS shooting_2016,
        "SHOOTING_2017" AS shooting_2017,
        "SHOOTING_2018" AS shooting_2018,
        "SHOOTING_2019" AS shooting_2019,
        "SHOOTING_2020" AS shooting_2020,
        "SHOOTING_2021" AS shooting_2021,
        "SHOOTING_2022" AS shooting_2022,
        "SHOOTING_RATE_2014" AS shooting_rate_2014,
        "SHOOTING_RATE_2015" AS shooting_rate_2015,
        "SHOOTING_RATE_2016" AS shooting_rate_2016,
        "SHOOTING_RATE_2017" AS shooting_rate_2017,
        "SHOOTING_RATE_2018" AS shooting_rate_2018,
        "SHOOTING_RATE_2019" AS shooting_rate_2019,
        "SHOOTING_RATE_2020" AS shooting_rate_2020,
        "SHOOTING_RATE_2021" AS shooting_rate_2021,
        "SHOOTING_RATE_2022" AS shooting_rate_2022,
        "THEFTFROMMV_2014" AS theftfrommv_2014,
        "THEFTFROMMV_2015" AS theftfrommv_2015,
        "THEFTFROMMV_2016" AS theftfrommv_2016,
        "THEFTFROMMV_2017" AS theftfrommv_2017,
        "THEFTFROMMV_2018" AS theftfrommv_2018,
        "THEFTFROMMV_2019" AS theftfrommv_2019,
        "THEFTFROMMV_2020" AS theftfrommv_2020,
        "THEFTFROMMV_2021" AS theftfrommv_2021,
        "THEFTFROMMV_2022" AS theftfrommv_2022,
        "THEFTFROMMV_RATE_2014" AS theftfrommv_rate_2014,
        "THEFTFROMMV_RATE_2015" AS theftfrommv_rate_2015,
        "THEFTFROMMV_RATE_2016" AS theftfrommv_rate_2016,
        "THEFTFROMMV_RATE_2017" AS theftfrommv_rate_2017,
        "THEFTFROMMV_RATE_2018" AS theftfrommv_rate_2018,
        "THEFTFROMMV_RATE_2019" AS theftfrommv_rate_2019,
        "THEFTFROMMV_RATE_2020" AS theftfrommv_rate_2020,
        "THEFTFROMMV_RATE_2021" AS theftfrommv_rate_2021,
        "THEFTFROMMV_RATE_2022" AS theftfrommv_rate_2022,
        "THEFTOVER_2014" AS theftover_2014,
        "THEFTOVER_2015" AS theftover_2015,
        "THEFTOVER_2016" AS theftover_2016,
        "THEFTOVER_2017" AS theftover_2017,
        "THEFTOVER_2018" AS theftover_2018,
        "THEFTOVER_2019" AS theftover_2019,
        "THEFTOVER_2020" AS theftover_2020,
        "THEFTOVER_2021" AS theftover_2021,
        "THEFTOVER_2022" AS theftover_2022,
        "THEFTOVER_RATE_2014" AS theftover_rate_2014,
        "THEFTOVER_RATE_2015" AS theftover_rate_2015,
        "THEFTOVER_RATE_2016" AS theftover_rate_2016,
        "THEFTOVER_RATE_2017" AS theftover_rate_2017,
        "THEFTOVER_RATE_2018" AS theftover_rate_2018,
        "THEFTOVER_RATE_2019" AS theftover_rate_2019,
        "THEFTOVER_RATE_2020" AS theftover_rate_2020,
        "THEFTOVER_RATE_2021" AS theftover_rate_2021,
        "THEFTOVER_RATE_2022" AS theftover_rate_2022
    FROM source
)

SELECT * FROM renamed
  );